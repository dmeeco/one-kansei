{% from 'snippets/icons.njk' import icon %}

<footer class="border-top py-5">
  <div class="container">
    <!-- Main Content -->
    <div class="row text-start align-items-end">
      <!-- Contact -->
      <div class="col-12 col-md-3 mb-4 mb-md-0 h-100 d-flex flex-column">
        <div class="mt-auto">
        <P class="text-uppercase fw-medium text-dark mb-3">Contact</P>
        <div>
          <a href="mailto:explore@kansei.one" class="link-fancy">explore@kansei.one</a>
          </div>
        </div>
      </div>
      
      <!-- Social -->
      <div class="col-12 col-md-3 mb-4 mb-md-0 h-100 d-flex flex-column">
        <div class="mt-auto">
        <p class="text-uppercase fw-medium text-dark mb-3">Follow</p>
        <div class="d-flex gap-3">
          <a href="https://linkedin.com/company/onekansei" class="link-fancy" target="_blank" rel="noopener">LinkedIn</a>
          <a href="https://instagram.com/onekansei" class="link-fancy" target="_blank" rel="noopener">Instagram</a>
          </div>
        </div>
      </div>
      
      <!-- Newsletter -->
      <div class="col-12 col-md-3 mb-4 mb-md-0 h-100 d-flex flex-column">
        <div class="mt-auto">
        <p class="text-uppercase fw-medium text-dark mb-3">Newsletter</p>
        <a href="#" class="link-fancy" data-bs-toggle="modal" data-bs-target="#newsletterModal">
          Join Newsletter ↗
        </a>
        </div>
      </div>
      
      <!-- Green Hosting Badge -->
      <div class="col-12 col-md-3">
        <p class="text-uppercase fw-medium text-dark mb-3">Verified</p>
        <img src="https://app.greenweb.org/api/v3/greencheckimage/kansei.one?nocache=true" alt="This website runs on green hosting - verified by thegreenwebfoundation.org" width="200px" height="95px">
      </div>
    </div>
    
    <!-- Bottom Section -->
    <div class="border-top mt-5 pt-4">
      <div class="row align-items-center">
        <div class="col-12 col-md-6 text-center text-md-start mb-3 mb-md-0">
          <span class="text-muted small">© 2025 One Kansei</span>
        </div>
        <div class="col-12 col-md-6 text-center text-md-end">
          <a href="{{ '/special-thanks/' | url }}" class="text-muted text-decoration-none small me-3">Special Thanks</a>
          <a href="{{ '/privacy-policy/' | url }}" class="text-muted text-decoration-none small">Privacy Policy</a>
        </div>
      </div>
    </div>
  </div>
</footer>

<!-- Newsletter Modal -->
<div class="modal fade" id="newsletterModal" tabindex="-1" aria-labelledby="newsletterModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content border-0 shadow-lg rounded-4">
      <div class="modal-header border-0 pb-0">
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body px-4 pb-4">
        <div class="text-center mb-4">
          <div class="mb-3">
            <i class="bi bi-envelope text-dark" style="font-size: 2rem;"></i>
          </div>
          <h3 class="h4 fw-bold mb-3">Your Privacy Is Important To Us!</h3>
        </div>
        
        <div class="text-muted mb-4">
          <p class="mb-3">We believe in meaningful connections, not data collection.</p>
          <p class="mb-3">If you're curious about conscious design, climate innovations, or how we're making a difference, we'd love to share our journey with you.</p>
          <p class="mb-0"><strong>No spam, no tracking, no nonsense.</strong> Just thoughtful insights delivered with care.</p>
        </div>

        <!-- Newsletter Signup Form -->
        <form id="newsletter-form" class="mb-4">
          <div class="mb-3">
            <label for="email" class="form-label fw-medium">Email Address</label>
            <input 
              type="email" 
              class="form-control form-control-lg" 
              id="email" 
              name="email" 
              placeholder="your@email.com"
              required
            >
          </div>
          <div class="text-center">
            <button type="submit" class="btn btn-primary px-4 py-2" id="submit-btn">
              <span class="btn-text">Subscribe</span>
              <span class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
              {{ icon("arrow-up-right", "ms-2", "16") }}
            </button>
          </div>
        </form>

        <!-- Success/Error Messages -->
        <div id="form-messages" class="text-center" style="display: none;">
          <div id="success-message" class="alert alert-success d-none" role="alert">
            <i class="bi bi-check-circle me-2"></i>
            <span id="success-text">Thank you! Please check your email to confirm your subscription.</span>
          </div>
          <div id="error-message" class="alert alert-danger d-none" role="alert">
            <i class="bi bi-exclamation-triangle me-2"></i>
            <span id="error-text">Something went wrong. Please try again.</span>
          </div>
        </div>

        <div class="text-center">
          <p class="small text-muted mt-3 mb-0">
            We respect your privacy. You can unsubscribe at any time.
          </p>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
// Newsletter form handler
document.addEventListener('DOMContentLoaded', function() {
  const form = document.getElementById('newsletter-form');
  const submitBtn = document.getElementById('submit-btn');
  const btnText = submitBtn.querySelector('.btn-text');
  const btnSpinner = submitBtn.querySelector('.spinner-border');
  const messagesDiv = document.getElementById('form-messages');
  const successDiv = document.getElementById('success-message');
  const errorDiv = document.getElementById('error-message');
  const successText = document.getElementById('success-text');
  const errorText = document.getElementById('error-text');

  form.addEventListener('submit', async function(e) {
    e.preventDefault();
    
    // Show loading state
    submitBtn.disabled = true;
    btnText.textContent = 'Subscribing...';
    btnSpinner.classList.remove('d-none');
    messagesDiv.style.display = 'none';
    successDiv.classList.add('d-none');
    errorDiv.classList.add('d-none');
    
    try {
      const formData = new FormData(form);
      formData.append('source', 'website_footer');
      
      const response = await fetch('/api/newsletter', {
        method: 'POST',
        body: formData
      });
      
      const data = await response.json();
      
      if (data.success) {
        successText.textContent = data.message;
        successDiv.classList.remove('d-none');
        form.reset();
        
        // If already subscribed, show different message
        if (data.already_subscribed) {
          successText.textContent = 'You are already subscribed to our newsletter!';
        }
      } else {
        errorText.textContent = data.error || 'Something went wrong. Please try again.';
        errorDiv.classList.remove('d-none');
      }
      
      messagesDiv.style.display = 'block';
      
    } catch (error) {
      console.error('Newsletter signup error:', error);
      errorText.textContent = 'Network error. Please check your connection and try again.';
      errorDiv.classList.remove('d-none');
      messagesDiv.style.display = 'block';
    } finally {
      // Reset button state
      submitBtn.disabled = false;
      btnText.textContent = 'Subscribe';
      btnSpinner.classList.add('d-none');
    }
  });
});
</script>

<script src="{{ '/js/bootstrap.bundle.min.js' | url }}"></script>